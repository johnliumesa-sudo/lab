#+TITLE: Roblox Game Design Document
#+AUTHOR: Aaron Liu
#+DESCRIPTION: A master literate programming file for the Coin Collection game.
* server script service
** coin logic (coinscript)
:properties:
:header-args:lua: :tangle ./src/server/CoinScript.server.luau
:END:
*** notes
This script handles the individual behavior of a coin. It defines the visual appearance, the rotation animation, and the logic for what happens when a player touches it (giving money and destroying itself).
*** code
**** variables
#+begin_src lua
  local coinBase = Instance.new("Part")
  coinBase.Parent = game:GetService("ReplicatedStorage"):FindFirstChild("Shared"):FindFirstChild("currencies")
  coinBase.Anchored = true

  local coin = Instance.new ("SpecialMesh")
  coin.Parent = coinBase
  coin.MeshId = "rbxassetid://71877336332186"
  coin.TextureId = "rbxassetid://9460443119"

  local rotationRate = 3
  local Players = game:GetService("Players")
  local collectablesFolder = game:GetService("Workspace"):FindFirstChild("Collectables")
#+end_src
**** functions
***** rotation
#+begin_src lua
  local function rotate()
      script.Parent.CFrame *= CFrame.Angles(0, rotationRate, 0)
  end
#+end_src
***** onTouched
#+begin_src lua
  local function onTouched(otherPart)
      local character = otherPart.Parent
      local humanoid = character:FindFirstChildWhichIsA("Humanoid")
      if humanoid then
  	local player = Players:GetPlayerFromCharacter(character)
  	local leaderstats = player:WaitForChild("leaderstats")
  	local coinCount = leaderstats:WaitForChild("CoinCount")
  	script.Parent:Destroy()
  	leaderstats.CoinCount.Value += 10
      end
  end
#+end_src
**** executions
#+begin_src lua
  game:GetService("RunService").Heartbeat:Connect(rotate)
  
  if script.Parent.Parent == collectablesFolder then
    script.Parent.Touched:Connect(onTouched)
  end
#+end_src
** spawner logic (coinspawner)
:properties:
:header-args:lua: :tangle ./src/server/CoinSpawner.server.luau
:END:
*** notes
This script manages the game loop for spawning coins. It clones the coin template defined in ReplicatedStorage and scatters them randomly across the map.
*** code
**** variables
#+begin_src lua
  local ReplicatedStorage = game:GetService("ReplicatedStorage")
  local collectable = ReplicatedStorage:FindFirstChild("Shared"):FindFirstChild("currencies"):WaitForChild("Part")
  local coinScript = script.Parent:FindFirstChild("CoinScript")
  coinScript.Parent = collectable
  local Workspace = game:GetService("Workspace")
  local collectablesFolder = workspace:FindFirstChild("Collectables")
  local spawnRange = 48
  local coinCount = 21
#+end_src
**** functions
***** randomSpawn
#+begin_src lua
  local function randomSpawn()
    local xpos = math.random (1, spawnRange)
    local zpos = math.random (1, spawnRange)
    local ypos = math.random (5, 30)
    local collectablesClone = collectable:Clone()
    collectablesClone.Parent = collectablesFolder
    collectablesClone.Position = Vector3.new(xpos,ypos,zpos)
    local coinScriptClone = collectablesClone:WaitForChild("CoinScript")
    coinScriptClone.Parent = collectablesClone
    return
  end
#+end_src
***** movements
#+begin_src lua
  local function movements(collectablesClone)
    local spinRate = math.rad
    while true do
	-- Movement logic placeholder
    end
  end
#+end_src
**** executions
#+begin_src lua
  for i = 1, coinCount do
      randomSpawn()
  end
#+end_src
** player stats (leaderstats)
:properties:
:header-args:lua: :tangle ./src/server/Leaderstats.server.luau
:END:
*** notes
This script runs whenever a player joins the game. It creates the standard Roblox "leaderstats" folder, which allows the default player list UI to show the player's coin count.
*** code
**** variables
#+begin_src lua
  local players = game:GetService("Players")
#+end_src
**** functions
***** onPlayerSpawn
#+begin_src lua
  local function onPlayerSpawn(player)
    local leaderstats = Instance.new("Folder")
    leaderstats.Name = "leaderstats"
    leaderstats.Parent = player
    local coinCount = Instance.new("IntValue")
    coinCount.Name = "CoinCount"
    coinCount.Parent = leaderstats
    coinCount.Value = 0
  end
#+end_src
**** executions
#+begin_src lua
  players.PlayerAdded:Connect(onPlayerSpawn)
#+end_src
* replicated storage 
* workspace 
